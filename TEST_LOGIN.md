# ðŸ” Google OAuth ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰

## ðŸ“‹ ç¢ºèªæ‰‹é †

### 1. ç’°å¢ƒå¤‰æ•°ã®ç¢ºèª

ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã§ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã§ãã¾ã™ï¼š

```bash
node check-env.js
```

ã¾ãŸã¯ã€ä»¥ä¸‹ã®ã‚³ãƒžãƒ³ãƒ‰ã§å€‹åˆ¥ã«ç¢ºèªï¼š

```bash
# ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
echo "DATABASE_URL: ${DATABASE_URL:+è¨­å®šæ¸ˆã¿}"
echo "JWT_SECRET: ${JWT_SECRET:+è¨­å®šæ¸ˆã¿}"
echo "VITE_APP_ID: ${VITE_APP_ID:+è¨­å®šæ¸ˆã¿}"
echo "VITE_OAUTH_PORTAL_URL: ${VITE_OAUTH_PORTAL_URL:+è¨­å®šæ¸ˆã¿}"
```

### 2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®šæ–¹æ³•

#### æ–¹æ³•1: .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆæŽ¨å¥¨ï¼‰

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```bash
# .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
cat > .env << 'EOF'
DATABASE_URL=postgresql://postgres:your_password@db.xxxxx.supabase.co:5432/postgres
JWT_SECRET=your-random-secret-key-at-least-32-characters-long
VITE_APP_ID=123456789-abcdefghijklmnop.apps.googleusercontent.com
VITE_OAUTH_PORTAL_URL=https://oauth-server-url.com
NODE_ENV=development
EOF
```

#### æ–¹æ³•2: ç’°å¢ƒå¤‰æ•°ã‚’ç›´æŽ¥ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

```bash
export DATABASE_URL="postgresql://postgres:your_password@db.xxxxx.supabase.co:5432/postgres"
export JWT_SECRET="your-random-secret-key-at-least-32-characters-long"
export VITE_APP_ID="123456789-abcdefghijklmnop.apps.googleusercontent.com"
export VITE_OAUTH_PORTAL_URL="https://oauth-server-url.com"
export NODE_ENV="development"
```

### 3. ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ãŸã‚‰ã€ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼š

```bash
npm run dev
```

ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
Server running on http://localhost:3000/
```

### 4. ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ†ã‚¹ãƒˆ

1. **ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹**
   - http://localhost:3000 ã‚’é–‹ã

2. **æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ**
   - æœªèªè¨¼ã®å ´åˆã€è‡ªå‹•çš„ã«Googleãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   - Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
   - `@officedeyasai.jp`ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
   - ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸå¾Œã€ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

### 5. ãƒ­ã‚°ã‚¤ãƒ³ç¢ºèªãƒã‚¤ãƒ³ãƒˆ

âœ… **æ­£å¸¸ãªå‹•ä½œ**
- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- Googleèªè¨¼ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- `@officedeyasai.jp`ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹
- ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒä¿æŒã•ã‚Œã‚‹
- ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒç¶­æŒã•ã‚Œã‚‹

âŒ **å•é¡ŒãŒã‚ã‚‹å ´åˆ**
- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œãªã„ â†’ `VITE_OAUTH_PORTAL_URL`ã¨`VITE_APP_ID`ã‚’ç¢ºèª
- Googleèªè¨¼ã‚¨ãƒ©ãƒ¼ â†’ Google Cloud Consoleã®è¨­å®šã‚’ç¢ºèª
- ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ã•ã‚Œã‚‹ â†’ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ`@officedeyasai.jp`ã§çµ‚ã‚ã£ã¦ã„ã‚‹ã‹ç¢ºèª
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ â†’ `DATABASE_URL`ã‚’ç¢ºèª

## ðŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèª

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§F12ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã
2. ã€ŒConsoleã€ã‚¿ãƒ–ã‚’é–‹ã
3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª

### ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’ç¢ºèª

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’ç¢ºèªï¼š

- `[OAuth]`ã§å§‹ã¾ã‚‹ãƒ­ã‚° â†’ OAuthé–¢é€£
- `[Database]`ã§å§‹ã¾ã‚‹ãƒ­ã‚° â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£
- `[Auth]`ã§å§‹ã¾ã‚‹ãƒ­ã‚° â†’ èªè¨¼é–¢é€£

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•

#### 1. "VITE_OAUTH_PORTAL_URL is not configured"
- **åŽŸå› **: `VITE_OAUTH_PORTAL_URL`ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
- **è§£æ±º**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«`VITE_OAUTH_PORTAL_URL`ã‚’è¿½åŠ 

#### 2. "DATABASE_URL is not set"
- **åŽŸå› **: `DATABASE_URL`ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
- **è§£æ±º**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«`DATABASE_URL`ã‚’è¿½åŠ 

#### 3. "Access denied"
- **åŽŸå› **: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒ`@officedeyasai.jp`ã§çµ‚ã‚ã£ã¦ã„ãªã„
- **è§£æ±º**: `@officedeyasai.jp`ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³

#### 4. "OAuth callback failed"
- **åŽŸå› **: Google Cloud Consoleã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„
- **è§£æ±º**: Google Cloud Consoleã§`http://localhost:3000/api/oauth/callback`ã‚’è¿½åŠ 

## ðŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ãƒ†ã‚¹ãƒˆå‰ã«ä»¥ä¸‹ã‚’ç¢ºèªï¼š

- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `DATABASE_URL`ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] `JWT_SECRET`ãŒ32æ–‡å­—ä»¥ä¸Šã§è¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] `VITE_APP_ID`ãŒGoogle OAuth Client IDã®å½¢å¼ã«ãªã£ã¦ã„ã‚‹
- [ ] `VITE_OAUTH_PORTAL_URL`ãŒæ­£ã—ã„URLå½¢å¼ã«ãªã£ã¦ã„ã‚‹
- [ ] Google Cloud Consoleã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] Supabaseå´ã§Google OAuthãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹

## ðŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ãƒ­ã‚°ã‚¤ãƒ³ãŒæˆåŠŸã—ãŸã‚‰ï¼š

1. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ
2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä¿æŒã‚’ç¢ºèª
3. ç•°ãªã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒ†ã‚¹ãƒˆ
4. `@officedeyasai.jp`ä»¥å¤–ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

